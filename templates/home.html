<!DOCTYPE html>
<html>
  <head>
    <title>F1 Fantasy App</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #f8f9fa;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .section {
        background-color: #ffffff;
        border-radius: 10px;
        padding: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        margin-bottom: 2rem;
      }

      .card-title {
        font-size: 1.25rem;
        font-weight: bold;
      }

      .card-text {
        font-size: 1.25rem;
        color: #198754;
      }

      body {
        background-color: #f8f9fa;
      }
      .section {
        background-color: #ffffff;
        border-radius: 10px;
        padding: 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        margin-bottom: 2rem;
      }
      .card-title {
        font-size: 1.25rem;
        font-weight: bold;
      }
      .card-text {
        font-size: 1.25rem;
        color: #198754;
      }
    </style>
  </head>
  <body class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="display-4 fw-bold">The Fantasy Paddock</h1>
        <p class="text-muted mb-1">
          Last race scored: <strong>{{ last_race_used }}</strong>
        </p>
      </div>
      {% if current_user.is_authenticated %}
      <span class="me-2"
        >üëã Welcome, <strong>{{ current_user.username }}</strong></span
      >
      <a href="/profile" class="btn btn-outline-success">Profile</a>
      <form method="POST" action="/logout" style="display: inline">
        <button class="btn btn-outline-danger ms-2">Logout</button>
      </form>
      {% else %}
      <a href="/login" class="btn btn-outline-dark">Login</a>
      <a href="/signup" class="btn btn-outline-dark">Sign Up</a>
      {% endif %}
    </div>

    {% if top_drivers %}
    <div class="section">
      <h2 class="fw-bold mb-4">üî• Top 3 Drivers</h2>
      <div class="row">
        {% for d in top_drivers %}
        <div class="col-md-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title">{{ d.driver }}</h5>
              <p class="card-text">{{ d.points }} pts</p>
              <p class="card-text text-muted">üí∞ {{ d.value }}</p>
              <form
                method="POST"
                action="{{ url_for('generate_driver_rating_route') }}"
              >
                <input type="hidden" name="driver" value="{{ d.driver }}" />
                <button type="submit" class="btn btn-outline-primary btn-sm">
                  üîç View
                </button>
              </form>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <div class="section">
      <h2 class="fw-bold mb-4">üìã All Drivers</h2>
      <div class="row row-cols-1 row-cols-md-3 g-3">
        {% set top_driver_ids = top_drivers | map(attribute='driver') | list %}
        {% for d in drivers %} {% if d not in top_driver_ids %}
        <div class="col">
          <div class="card h-100 shadow-sm">
            <div class="card-body text-center">
              <h5 class="card-title">{{ driver_name_map.get(d, d) }}</h5>
              <form
                method="POST"
                action="{{ url_for('generate_driver_rating_route') }}"
              >
                <input type="hidden" name="driver" value="{{ d }}" />
                <button type="submit" class="btn btn-outline-primary btn-sm">
                  üîç View
                </button>
              </form>
            </div>
          </div>
        </div>
        {% endif %} {% endfor %}
      </div>
    </div>

    <div class="section text-center">
      <form
        method="POST"
        action="{{ url_for('clear_driver_ratings') }}"
        class="d-inline me-3"
      >
        <button type="submit" class="btn btn-danger">
          üóëÔ∏è Clear All Driver Ratings
        </button>
      </form>
      <form
        method="POST"
        action="{{ url_for('generate_all_driver_ratings_route') }}"
        class="d-inline"
      >
        <button type="submit" class="btn btn-dark">
          üõ†Ô∏è Generate All Driver Ratings
        </button>
      </form>
    </div>
  </body>
</html>
